


<!DOCTYPE html>
<html lang="it" dir="ltr">
  <head>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-656GGPQ9FS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-656GGPQ9FS');
</script>


    <meta name="title" content="Incendio del Vesuvio, estate 2017 | Massimiliano Moraca">
    <meta name="description" content="A metà luglio 2017 un vasto incendio ha distrutto il patrimonio boschivo del Parco Nazionale del Vesuvio. Questa mappa consente di vedere i danni a distanza di anni." />
    <meta name="keywords" content="gis consulenza tutorial formazione">
    <meta name="author" content="Massimiliano Moraca">
    <meta http-equiv="Reply-to" content="info@massimilianomoraca.it">
    <meta http-equiv="content-language" content="IT">
    <meta http-equiv="Content-Type" content="text/html; iso-8859-1">
    <meta name="robots" content="INDEX,FOLLOW">
    <meta name="creation_Date" content="18 Luglio 2021">
    <meta name="revisit-after" content="7 days">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Incendio del Vesuvio, estate 2017 | Massimiliano Moraca</title>
    <link rel="icon" href="https://massimilianomoraca.it/static/images/logo.png" type="image/gif">

    <!-- OpenGraph -->
    <meta property="og:title" content="Incendio del Vesuvio, estate 2017 | Massimiliano Moraca">
    <meta name="description" property="og:description" content="A metà luglio 2017 un vasto incendio ha distrutto il patrimonio boschivo del Parco Nazionale del Vesuvio. Questa mappa consente di vedere i danni a distanza di anni.">
    <meta property="og:type" content="article" >
    <meta property="og:image" content="http://massimilianomoraca.it/media/uploads/images/2021/08/01/incendio_vesuvio_2017.jpg">
    <meta property="og:url" content="massimilianomoraca.it/mappe/webgis/incendio-del-vesuvio-estate-2017/">
    <meta name="twitter:creator" content="@maxdragonheart" />
    <meta name="twitter:card" value="summary_large_image">
    <meta name="twitter:title" content="Incendio del Vesuvio, estate 2017 | Massimiliano Moraca">
    <meta name="twitter:description" content="A metà luglio 2017 un vasto incendio ha distrutto il patrimonio boschivo del Parco Nazionale del Vesuvio. Questa mappa consente di vedere i danni a distanza di anni." />
    <meta name="twitter:image" content="http://massimilianomoraca.it/media/uploads/images/2021/08/01/incendio_vesuvio_2017.jpg" />


<!-- JQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>
<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
  integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
  integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
  crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
  crossorigin="anonymous">
<!-- Font Awesome -->
<link rel="stylesheet"
  href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
  integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
  crossorigin="anonymous">
<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js"
  integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ"
  crossorigin="anonymous"></script>
<!-- Custom -->
<link rel="stylesheet"
  href="/static/css/commons.css">


<!-- CUSTOM FOR MAPS -->
    <link rel="stylesheet" href="/static/css/ol_custom.css">
    <link rel="stylesheet" href="/static/css/geomedia.css">
    <script src="/static/js/geomedia.js" type="text/javascript"></script>
<!-- OpenLayers 6 -->
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.14.1/build/ol.js"></script>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.14.1/css/ol.css">
<!-- ol-ext -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.css" />
    <script type="text/javascript" src="https://cdn.rawgit.com/Viglino/ol-ext/master/dist/ol-ext.min.js"></script>
<!-- Plotly JS -->
    <script src="https://cdn.plot.ly/plotly-2.11.1.min.js"></script>



  </head>
  <body>

    <div class="map-wrapper">

      <div class="map" id='map'></div>

      <div class="turn-back-map">
          <a class="btn btn-map" href="/mappe/webgis/">
              <span data-toggle="tooltip" data-placement="top" title="Torna indietro">
                <i class="fas fa-undo-alt"></i>
              </span>
          </a>
      </div>

      <div class="map-info">
          <button class="btn btn-map" type="button" data-bs-toggle="offcanvas" data-bs-target="#mapDescription" aria-controls="mapDescription">
            <span data-toggle="tooltip" data-placement="top" title="Descrizione">
              <i class="fas fa-book"></i>
            </span>
          </button>
          <div class="offcanvas offcanvas-end" tabindex="-1" id="mapDescription" aria-labelledby="mapDescriptionLabel">



<div class="offcanvas-header">
  <h5 class="offcanvas-title" id="mapDescriptionLabel">Incendio del Vesuvio, estate 2017</h5>
  <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
</div>
<div class="offcanvas-body">

  <article class="text-justify">
    <p>Questa mappa, <strong>non ottimizzata per tablet e smartphone ma liberamente gestibile da pc</strong>, sfrutta i dati del progetto <a href="https://sentinel.esa.int/web/sentinel/missions/sentinel-2" target="_blank" rel="noopener">Copernicus Sentinel-2</a> per dare una lettura di parte del territorio campano a partire dal 2015.</p>
<p>Vengono usati in particolare i dati relativi ai periodi estivi, combinati per calcolare l'indice NDVI che viene mostrato nell'area del grafico ogni volta che si clicca su un punto della mappa.</p>
<p>Attivando e disattivando i layer satellitari &egrave; possibile inoltre visionare anche lo stato dei luoghi relativo al giorno censito. Per il solo 12 luglio 2017 viene riportato anche un layer da sensore infrarosso(SWIR - Short Wave Infra-Red); questo tipo di sensore consente di penetrare nuvole e fumo e grazie ad esso &egrave; possibile individuare i roghi presenti nel <a href="../../../../../blog/gis/analisi-dei-dati-copernicus-relativi-agli-incendi-sul-vesuvio-del-2017/" target="_blank" rel="noopener">Parco Nazionale del Vesuvio</a> ed in altre zone della Regione in quel giorno.</p>
  </article>

</div>



          </div>
      </div>

      <div class="btn-map-legend">

          <button class="btn btn-map" type="button" data-bs-toggle="offcanvas" data-bs-target="#openMapControls" aria-controls="openMapControls">
            <span data-toggle="tooltip" data-placement="top" title="Descrizione">
              <i class="fas fa-layer-group"></i>
            </span>
          </button>

          <div class="offcanvas offcanvas-end" tabindex="-1" id="openMapControls" aria-labelledby="openMapControlsLabel">

            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="openMapControlsLabel">Layers</h5>
              <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>

            <div class="offcanvas-body">
              <div class="px-2">
                <div class="custom-control custom-switch">
                  <input type="radio" class="custom-control-input" name="switch-basemap" id="BASEMAP_OSM" checked>
                  <label class="custom-control-label" for="BASEMAP_OSM">Lite</label>
                </div>
                <div class="custom-control custom-switch">
                  <input type="radio" class="custom-control-input" name="switch-basemap" id="BASEMAP_OUTDOORS">
                  <label class="custom-control-label" for="BASEMAP_OUTDOORS">Topographic</label>
                </div>
                <div class="custom-control custom-switch">
                  <input type="radio" class="custom-control-input" name="switch-basemap" id="BASEMAP_MONOCROMEGRAY">
                  <label class="custom-control-label" for="BASEMAP_MONOCROMEGRAY">Monocrome Gray</label>
                </div>
                <div class="custom-control custom-switch">
                  <input type="radio" class="custom-control-input" name="switch-basemap" id="BASEMAP_SATELLITE">
                  <label class="custom-control-label" for="BASEMAP_SATELLITE">Satellite</label>
                </div>

                <hr>





    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="20_RGB_Campania_20200706">
      <label class="custom-control-label" for="20_RGB_Campania_20200706">RGB 6 luglio 2020</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="19_RGB_Campania_20190702">
      <label class="custom-control-label" for="19_RGB_Campania_20190702">RGB 2 luglio 2019</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="18_RGB_Campania_20180702">
      <label class="custom-control-label" for="18_RGB_Campania_20180702">RGB 2 luglio 2018</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="15_RGB_Campania_20170712">
      <label class="custom-control-label" for="15_RGB_Campania_20170712">RGB 12 luglio 2017</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="14_wildfires_20170712">
      <label class="custom-control-label" for="14_wildfires_20170712">SWIR 12 luglio 2017</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="13_RGB_Campania_20160712">
      <label class="custom-control-label" for="13_RGB_Campania_20160712">RGB 12 luglio 2016</label>
    </div>

    <div class="custom-control custom-switch">
      <input type="checkbox" class="custom-control-input" name="switch-basemap" id="12_RGB_Campania_20150807">
      <label class="custom-control-label" for="12_RGB_Campania_20150807">RGB 7 agosto 2015</label>
    </div>





              </div>
            </div>

          </div>

      </div>





  <div class="map-calculus">

      <button class="btn btn-map" type="button" data-bs-toggle="offcanvas" data-bs-target="#mapCalculus" aria-controls="mapCalculus">
        <span data-toggle="tooltip" data-placement="top" title="Analisi">
          <i class="fas fa-cogs"></i>
        </span>
      </button>

      <div class="offcanvas offcanvas-end" tabindex="-1" id="mapCalculus" aria-labelledby="mapCalculusLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="mapCalculusLabel">Dati processati</h5>
          <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">

          <article class="text-justify">
            <p>In questa mappa ci sono dati processati. Spunta il box che segue per visualizzare le tabelle e/o i grafici presenti.</p>
            <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="ShowData">
              <label class="custom-control-label" for="ShowData">Visualizza</label>
            </div>

            <p class="bg-warning mt-1 px-2" id="gotoaction" style="display: none;">Chiudi questa finestra e clicca su un punto della mappa per visualizzare le tabelle e/o i grafici.</p>
          </article>

        </div>
      </div>

  </div>

  <div class="card ol-popup" id="popup" style="display: none;">
    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
    <div id="popup-content"></div>
  </div>












    </div>

    <script type="text/javascript">

      var map = new ol.Map({
        target: 'map',
        controls: ol.control.defaults({
          attribution: false
        }),
      });

      var scaleLine = new ol.control.ScaleLine({
        className: 'ol-scale-line',
        target: document.getElementById('scale-line')
      });
      map.addControl(scaleLine);

      var attribution = new ol.control.Attribution({
        className: 'ol-attribution',
        label: 'a',
        collapsible: true,
        collapsed: true,
        target: document.getElementById('map-attribution'),
      });
      map.addControl(attribution);


var view = new ol.View({
  center: ol.proj.fromLonLat([14.42637, 40.82115]),
  zoom: 13,
  maxZoom: 16,
  minZoom: 10
});
map.setView(view);


      var osm = new ol.layer.Tile({
        source: new ol.source.OSM(),
        zIndex: 0
      });
      map.addLayer(osm);
      $('#BASEMAP_OSM').on('change', function() {
        let isChecked = $(this).is(':checked');
        if (isChecked) {
          map.addLayer(osm);
          map.removeLayer(outdoors);
          map.removeLayer(monocromeGray);
          map.removeLayer(satellite);
        } else {
          map.removeLayer(osm);
        }
      });

      var mapAttribution = '<a href="https://massimilianomoraca.it/" target="_blank">Massimiliano Moraca</a> has created this map using <a href="https://openlayers.org/" target="_blank">OpenLayers</a>'
      var userMapBox = 'maxdragonheart'
      var tokenMapBox = 'pk.eyJ1IjoibWF4ZHJhZ29uaGVhcnQiLCJhIjoiY2p4a2k3a2twMmF2aDN4czhwMzBoZ2x1eCJ9.upAxT3LK0NCiP_jBcErzNw'

      var outdoors = new ol.layer.Tile({
        title: 'Topographic',
        source: new ol.source.XYZ({
            attributions: mapAttribution,
            url: 'https://api.mapbox.com/styles/v1/' + userMapBox + '/'
                + 'cjxkimp5j5s0o1ct4b68n4x1p/tiles/256/{z}/{x}/{y}?'
                + 'access_token=' + tokenMapBox + ''
          }),
        zIndex: 0,
      });
      $('#BASEMAP_OUTDOORS').on('change', function() {
        let isChecked = $(this).is(':checked');
        if (isChecked) {
          map.addLayer(outdoors);
          map.removeLayer(osm);
          map.removeLayer(monocromeGray);
          map.removeLayer(satellite);
        } else {
          map.removeLayer(outdoors);
        }
      });

      var monocromeGray = new ol.layer.Tile({
        title: 'MonocromeGray',
        source: new ol.source.XYZ({
            attributions: mapAttribution,
            url: 'https://api.mapbox.com/styles/v1/' + userMapBox + '/'
                + 'ckcqb7nu809mu1inv9lfuj2ut/tiles/256/{z}/{x}/{y}?'
                + 'access_token=' + tokenMapBox + ''
          }),
        zIndex: 0,
      });
      $('#BASEMAP_MONOCROMEGRAY').on('change', function() {
        let isChecked = $(this).is(':checked');
        if (isChecked) {
          map.addLayer(monocromeGray);
          map.removeLayer(osm);
          map.removeLayer(outdoors);
          map.removeLayer(satellite);
        } else {
          map.removeLayer(monocromeGray);
        }
      });

      var satellite = new ol.layer.Tile({
        title: 'Satellite',
        source: new ol.source.XYZ({
            attributions: mapAttribution,
            url: 'https://api.mapbox.com/styles/v1/' + userMapBox + '/'
                + 'ck0l7j9cx27df1clhcyok70mk/tiles/256/{z}/{x}/{y}?'
                + 'access_token=' + tokenMapBox + ''
          }),
        zIndex: 0,
      });
      $('#BASEMAP_SATELLITE').on('change', function() {
        let isChecked = $(this).is(':checked');
        if (isChecked) {
          map.addLayer(satellite);
          map.removeLayer(osm);
          map.removeLayer(outdoors);
          map.removeLayer(monocromeGray);
        } else {
          map.removeLayer(satellite);
        }
      });









    

  
  

  var wmsRGBCampania20200706 = new ol.layer.Tile({
    title: 'RGB 6 luglio 2020',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20200706',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#20_RGB_Campania_20200706').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20200706);
      } else {
        map.removeLayer(wmsRGBCampania20200706);
      }
  });

  

  var wmsRGBCampania20190702 = new ol.layer.Tile({
    title: 'RGB 2 luglio 2019',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20190702',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#19_RGB_Campania_20190702').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20190702);
      } else {
        map.removeLayer(wmsRGBCampania20190702);
      }
  });

  

  var wmsRGBCampania20180702 = new ol.layer.Tile({
    title: 'RGB 2 luglio 2018',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20180702',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#18_RGB_Campania_20180702').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20180702);
      } else {
        map.removeLayer(wmsRGBCampania20180702);
      }
  });

  

  var wmsRGBCampania20170712 = new ol.layer.Tile({
    title: 'RGB 12 luglio 2017',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20170712',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#15_RGB_Campania_20170712').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20170712);
      } else {
        map.removeLayer(wmsRGBCampania20170712);
      }
  });

  

  var wmswildfires20170712 = new ol.layer.Tile({
    title: 'SWIR 12 luglio 2017',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'wildfires_20170712',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#14_wildfires_20170712').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmswildfires20170712);
      } else {
        map.removeLayer(wmswildfires20170712);
      }
  });

  

  var wmsRGBCampania20160712 = new ol.layer.Tile({
    title: 'RGB 12 luglio 2016',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20160712',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#13_RGB_Campania_20160712').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20160712);
      } else {
        map.removeLayer(wmsRGBCampania20160712);
      }
  });

  

  var wmsRGBCampania20150807 = new ol.layer.Tile({
    title: 'RGB 7 agosto 2015',
    source: new ol.source.TileWMS({
      url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
      params: {
        'LAYERS': 'RGB_Campania_20150807',
        'STYLES': null,
      }
    }),
    minZoom: 0,
    maxZoom: 28,
    zIndex: 1,
    opacity: 1.00
  });
  $('#12_RGB_Campania_20150807').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {
        map.addLayer(wmsRGBCampania20150807);
      } else {
        map.removeLayer(wmsRGBCampania20150807);
      }
  });

  
  





    

  





    


  
    $('#ShowData').on('change', function() {
      let isChecked = $(this).is(':checked');
      if (isChecked) {

        $("#gotoaction").show();
        $("#popup").show();

        var container = document.getElementById('popup');
        var content = document.getElementById('popup-content');
        var closer = document.getElementById('popup-closer');
        var popup = new ol.Overlay({
          element: container,
          autoPan: true,
          autoPanAnimation: {
            duration: 250,
          },
        });
        closer.onclick = function () {
          popup.setPosition(undefined);
          closer.blur();
          return false;
        };
        map.addOverlay(popup);

        map.on('singleclick', function(evt) {
          let viewResolution = view.getResolution();

          var getfeatureinfo_array = [];

          
          var sourceNDVICampania20200706 = new ol.layer.Tile({
            title: 'NDVI 6 luglio 2020',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20200706',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20200706 = sourceNDVICampania20200706.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20200706)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20200706 = json.properties.GRAY_INDEX;

            data_NDVICampania20200706 = [
                '20200706',
                '06 Luglio 2020',
                pixelvalue_NDVICampania20200706
              ]
            getfeatureinfo_array.push(data_NDVICampania20200706);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20190702 = new ol.layer.Tile({
            title: 'NDVI 2 luglio 2019',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20190702',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20190702 = sourceNDVICampania20190702.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20190702)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20190702 = json.properties.GRAY_INDEX;

            data_NDVICampania20190702 = [
                '20190702',
                '02 Luglio 2019',
                pixelvalue_NDVICampania20190702
              ]
            getfeatureinfo_array.push(data_NDVICampania20190702);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20180702 = new ol.layer.Tile({
            title: 'NDVI 2 luglio 2018',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20180702',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20180702 = sourceNDVICampania20180702.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20180702)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20180702 = json.properties.GRAY_INDEX;

            data_NDVICampania20180702 = [
                '20180702',
                '02 Luglio 2018',
                pixelvalue_NDVICampania20180702
              ]
            getfeatureinfo_array.push(data_NDVICampania20180702);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20170806 = new ol.layer.Tile({
            title: 'NDVI 6 agosto 2017',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20170806',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20170806 = sourceNDVICampania20170806.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20170806)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20170806 = json.properties.GRAY_INDEX;

            data_NDVICampania20170806 = [
                '20170806',
                '06 Agosto 2017',
                pixelvalue_NDVICampania20170806
              ]
            getfeatureinfo_array.push(data_NDVICampania20170806);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20170712 = new ol.layer.Tile({
            title: 'NDVI 12 luglio 2017',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20170712',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20170712 = sourceNDVICampania20170712.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20170712)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20170712 = json.properties.GRAY_INDEX;

            data_NDVICampania20170712 = [
                '20170712',
                '12 Luglio 2017',
                pixelvalue_NDVICampania20170712
              ]
            getfeatureinfo_array.push(data_NDVICampania20170712);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20160712 = new ol.layer.Tile({
            title: 'NDVI 12 luglio 2016',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20160712',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20160712 = sourceNDVICampania20160712.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20160712)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20160712 = json.properties.GRAY_INDEX;

            data_NDVICampania20160712 = [
                '20160712',
                '12 Luglio 2016',
                pixelvalue_NDVICampania20160712
              ]
            getfeatureinfo_array.push(data_NDVICampania20160712);

          }).catch((error) => {
            console.warn(error)
          });
          
          var sourceNDVICampania20150807 = new ol.layer.Tile({
            title: 'NDVI 7 agosto 2015',
            source: new ol.source.TileWMS({
              url: 'https://geoserver.massimilianomoraca.me/geoserver/MassimilianoMoraca/wms',
              params: {
                'LAYERS': 'NDVI_Campania_20150807',
                'STYLES': null,
              }
            }),
            minZoom: 28,
            maxZoom: 0,
            zIndex: 1,
            opacity: 1.00
          });
          let url_NDVICampania20150807 = sourceNDVICampania20150807.getSource().getFeatureInfoUrl(
            evt.coordinate, viewResolution, 'EPSG:3857',
            {
              'INFO_FORMAT': 'application/json',
              'propertyName': 'GRAY_INDEX',
            });
          fetch(url_NDVICampania20150807)
          .then(function (response) {
            return response.text(); })
          .then(function (data) {

            json = JSON.parse(data).features[0];

            pixelvalue_NDVICampania20150807 = json.properties.GRAY_INDEX;

            data_NDVICampania20150807 = [
                '20150807',
                '07 Agosto 2015',
                pixelvalue_NDVICampania20150807
              ]
            getfeatureinfo_array.push(data_NDVICampania20150807);

          }).catch((error) => {
            console.warn(error)
          });
          

          /// Waiting fo JSON response
          setTimeout(function(){
            let sorted_array = getfeatureinfo_array.sort(function(a,b){ return a[0]- b[0] })
            var x_data = [];
            var y_data = [];
            /// Extract single elements from the array
            for (items in sorted_array) {
              x_items = sorted_array[items][1]
              x_data.push(x_items);

              y_items = sorted_array[items][2]
              y_data.push(y_items);

            };
            /// Plotly.JS Scatter
            var data = [
              {
                x: x_data,
                y: y_data,
                type: 'scatter'
              }
            ];

            var layout = {
                title: 'Analisi NDVI',
                showlegend: false
            };
            Plotly.newPlot('getfeatureinfo-chart', data, layout, {scrollZoom: true});

          }, 3000);

          var coordinate = evt.coordinate;
          content.innerHTML = '<div class="" id="getfeatureinfo-chart"></div>';
          popup.setPosition(coordinate);

        });

      } else {
        $("#gotoaction").hide();
        $("#popup").hide();
      }
    });

  






    </script>

  </body>
</html>
