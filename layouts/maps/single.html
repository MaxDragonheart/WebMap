{{ define "main" }}
<!-- Mappa full-screen -->
<div id="map" class="map-container">

  <!-- Basemap picker (alto-dx, dentro la mappa) -->
  <div id="basemap-control" class="ol-control basemap-control">
    <button id="basemap-toggle" type="button" aria-expanded="false">Basemap ▾</button>
    <div id="basemap-menu" class="menu hidden" aria-hidden="true"></div>
  </div>

  <!-- Status bar (basso-centro): coord + barra di scala -->
  <div id="status-bar" class="status-bar">
    <span id="coords">Lon: —  Lat: —</span>
    <div id="scale-line"></div>
  </div>

  <!-- Reset (sotto ai bottoni di zoom di OpenLayers) -->
  <div id="reset-control" class="ol-control reset-control">
    <button id="reset-btn" type="button" title="Reset view">↺</button>
  </div>

</div>

<!-- Passo la config dal data -->
{{ $basename := .File.TranslationBaseName | default .File.BaseFileName }}
{{ $k1 := $basename }}
{{ $k2 := printf "%s-map" $basename }}
{{ $k3 := printf "%s_map" $basename }}
{{ $cfg := or (index site.Data.maps $k1) (index site.Data.maps $k2) (index site.Data.maps $k3) }}

<script>
  window.__MAP_CONFIG__ = {{ $cfg | jsonify }};
  window.__MAP_TITLE__  = {{ .Title | jsonify }};
</script>
{{ end }}
