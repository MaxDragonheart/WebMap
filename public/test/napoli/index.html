<!DOCTYPE html>
<html lang="it">
<head><script src="/WebMap/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=WebMap/livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="https://massimilianomoraca.me/static/images/logo.webp" type="image/webp">

  <title>Test â€“ Napoli â€“ WebMap</title>
  <meta name="description" content="Mappa di test centrata su Napoli con OpenLayers.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@7.3.0/ol.css">
  
  <link rel="stylesheet" href="/WebMap/css/site.css">
</head>
<body>
  <main>
    
  
  
  <div class="map-wrapper">
  <div id="map" class="map"></div>

  

  
  <div id="popup" class="ol-popup">
    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
    <div id="popup-content"></div>
  </div>
  

  
  <div class="map-top-center" id="map-coords">
    <span class="coord-label">Lon:</span>
    <span id="lon-value" class="coord-value">â€”</span>
    <span class="sep">|</span>
    <span class="coord-label">Lat:</span>
    <span id="lat-value" class="coord-value">â€”</span>
  </div>

  
  <div class="map-basemap" id="bm-root">
    <button type="button" id="bm-btn" class="bm-btn" aria-label="Basemap">
      
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
        <path d="M12 3L1 9l11 6 11-6-11-6zm0 8L1 5v4l11 6 11-6V5l-11 6zm0 4L1 11v4l11 6 11-6v-4l-11 4z" fill="currentColor"/>
      </svg>
    </button>
    <div class="bm-panel" id="bm-panel" hidden>
      <div class="bm-title">Basemap</div>
      <ul class="bm-list" id="bm-list"></ul>
    </div>
  </div>
</div>

<script>
  window.__MAP_CONFIG__ = "{\"basemaps\":[{\"id\":\"osm\",\"name\":\"OSM\",\"type\":\"osm\"},{\"attribution\":\"Tiles Â© Esri\",\"id\":\"esri_sat\",\"name\":\"Esri Sat\",\"type\":\"xyz\",\"url\":\"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"}],\"center\":[14.251409703644354,40.84578475094159],\"controls\":{\"fullscreen\":true,\"scaleLine\":true,\"slider\":false},\"defaultBasemap\":\"osm\",\"description\":\"Mappa di test centrata su Napoli con OpenLayers.\",\"points\":[{\"coord\":[14.251409703644354,40.84578475094159],\"name\":\"Napoli\"}],\"popup\":{\"content\":\"ðŸ“ {name}\\u003cbr\\u003eLon: {lon}, Lat: {lat}\",\"enabled\":true},\"raster\":{\"enabled\":false},\"title\":\"Test â€“ Napoli\",\"zoom\":12}";
  document.addEventListener("DOMContentLoaded", function(){
    const map = window.createMap(window.__MAP_CONFIG__, "map", {
      popupContainerId: "popup",
      popupCloserId: "popup-closer",
      popupContentId: "popup-content",
      opacitySliderId: "opacity"
    });

    
    if (map && window.getMouseCoordinates) {
      window.getMouseCoordinates(map, "lon-value", "lat-value");
    }

    
    const root = document.getElementById("bm-root");
    const btn  = document.getElementById("bm-btn");
    const panel = document.getElementById("bm-panel");

    if (window.initBasemapPanel) {
      window.initBasemapPanel("bm-list", window.__MAP_CONFIG__, function(){
        
        panel.hidden = true;
        root.classList.remove("open");
      });
    }

    
    btn.addEventListener("click", function (e) {
      e.stopPropagation();
      const willOpen = panel.hidden;
      document.querySelectorAll(".bm-panel").forEach(p => { p.hidden = true; });
      document.querySelectorAll(".map-basemap").forEach(r => r.classList.remove("open"));
      panel.hidden = !willOpen;
      root.classList.toggle("open", willOpen);
    });

    
    document.addEventListener("click", function (e) {
      if (!root.contains(e.target)) {
        panel.hidden = true;
        root.classList.remove("open");
      }
    });
  });
</script>


  </main>

  
  <script src="https://cdn.jsdelivr.net/npm/ol@7.3.0/dist/ol.js"></script>
  
  <script src="/WebMap/js/map-factory.js"></script>
  

</body>
</html>
